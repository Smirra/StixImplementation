using System.ComponentModel.DataAnnotations;

namespace Vulnerabilities.Api.Models;
public class VulnerabilityDTO
{
    [Required]
    [RegularExpression("^vulnerability$", ErrorMessage = "Type must be 'vulnerability'")]
    public string? Type { get; set; }
    [Required]
    [RegularExpression(@"^2\.1$", ErrorMessage = "SpecVersion must be '2.1'")]
    public string? SpecVersion { get; set; }
    public DateTime? Created { get; set; }
    public DateTime? Modified { get; set; }
    [Required]
    [RegularExpression(@"^CVE-\d{4}-\d{4,7}$")]
    public string? Name { get; set; }
    public string? Description { get; set; }

    [Range(0, 100, ErrorMessage = "The Magnusson-severity must be between 0 and 100")]
    public int? MagnussonSeverity { get; set; }
    [RegularExpression(@"^(open|resolved|dismissed)$", ErrorMessage = "Status must be 'open', 'resolved' or 'dismissed'")]
    public string? Status { get; set; }
}